CREATE TABLE IF NOT EXISTS SYMBOL(
SYMBOL_NAME VARCHAR(256),
PRIMARY KEY (SYMBOL_NAME)
);

CREATE TABLE IF NOT EXISTS ACCOUNT(
ACCOUNT_ID BIGINT,
BALANCE DOUBLE PRECISION,
PRIMARY KEY (ACCOUNT_ID)
);

CREATE TABLE IF NOT EXISTS POSITION(
SYMBOL_NAME VARCHAR(256),
ACCOUNT_ID BIGINT,
AMOUNT DOUBLE PRECISION,
CONSTRAINT POSITION_PK PRIMARY KEY (SYMBOL_NAME, ACCOUNT_ID),
FOREIGN KEY (ACCOUNT_ID) REFERENCES ACCOUNT (ACCOUNT_ID) ON DELETE SET NULL ON UPDATE CASCADE,
FOREIGN KEY (SYMBOL_NAME) REFERENCES SYMBOL (SYMBOL_NAME) ON DELETE SET NULL ON UPDATE CASCADE
);

CREATE TABLE IF NOT EXISTS TRANSACTIONS(
TRANS_ID BIGSERIAL,
STATUS VARCHAR(256),
SYMBOL_NAME VARCHAR(256),
ACCOUNT_ID BIGINT,
AMOUNT DOUBLE PRECISION,
LIMIT_PRICE DOUBLE PRECISION,
TIME BIGINT,
PRIMARY KEY (TRANS_ID),
FOREIGN KEY (ACCOUNT_ID) REFERENCES ACCOUNT (ACCOUNT_ID) ON DELETE SET NULL ON UPDATE CASCADE,
FOREIGN KEY (SYMBOL_NAME) REFERENCES SYMBOL (SYMBOL_NAME) ON DELETE SET NULL ON UPDATE CASCADE
);

CREATE TABLE IF NOT EXISTS DEAL(
DEAL_ID BIGSERIAL,
TRANS_ID BIGINT,
AMOUNT DOUBLE PRECISION,
PRICE DOUBLE PRECISION,
TIME BIGINT,
PRIMARY KEY (DEAL_ID),
FOREIGN KEY (TRANS_ID) REFERENCES TRANSACTIONS (TRANS_ID) ON DELETE SET NULL ON UPDATE CASCADE
);

CREATE TABLE IF NOT EXISTS CANCELTIME(
TRANS_ID BIGINT,
CANCEL_TIME BIGINT,
PRIMARY KEY (TRANS_ID), 
FOREIGN KEY (TRANS_ID) REFERENCES TRANSACTIONS (TRANS_ID) ON DELETE SET NULL ON UPDATE CASCADE
);